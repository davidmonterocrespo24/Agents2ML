Execution Result for model_h2o_training.py
--------------------------------------------------
Execution error (not missing module). Attempts: 1
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:75: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  parsed = pd.to_datetime(df[col], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:75: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  parsed = pd.to_datetime(df[col], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:75: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  parsed = pd.to_datetime(df[col], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:75: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  parsed = pd.to_datetime(df[col], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:75: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  parsed = pd.to_datetime(df[col], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:75: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  parsed = pd.to_datetime(df[col], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:75: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  parsed = pd.to_datetime(df[col], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:75: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  parsed = pd.to_datetime(df[col], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:183: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  df[c] = pd.to_datetime(df[c], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:183: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  df[c] = pd.to_datetime(df[c], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:183: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  df[c] = pd.to_datetime(df[c], errors='coerce', dayfirst=True, infer_datetime_format=True)
/workspace/pipeline_3ee8ca9e-5834-4f88-a64d-e4a2ec2834dc/model_h2o_training.py:183: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  df[c] = pd.to_datetime(df[c], errors='coerce', dayfirst=True, infer_datetime_format=True)
LOG_START:DATA_SUMMARY
{"n_rows": 105830, "n_cols": 6, "dtypes": {"factura_nombre": "object", "factura_monto_total": "float64", "factura_total_descuentos": "float64", "factura_total_pagos": "float64", "vendedor_id": "float64", "cliente_nombre": "object"}, "n_nulls": {"factura_nombre": 0, "factura_monto_total": 0, "factura_total_descuentos": 0, "factura_total_pagos": 0, "vendedor_id": 79, "cliente_nombre": 570}, "sample": [{"factura_nombre": "/", "factura_monto_total": 0.0, "factura_total_descuentos": 0.0, "factura_total_pagos": 0.0, "vendedor_id": 1.0, "cliente_nombre": NaN}, {"factura_nombre": "/", "factura_monto_total": 0.0, "factura_total_descuentos": 0.0, "factura_total_pagos": 0.0, "vendedor_id": 2.0, "cliente_nombre": NaN}, {"factura_nombre": "/", "factura_monto_total": 0.0, "factura_total_descuentos": 0.0, "factura_total_pagos": 0.0, "vendedor_id": 2.0, "cliente_nombre": NaN}]}
LOG_END:DATA_SUMMARY
Checking whether there is an H2O instance running at http://localhost:54321..... not found.
Attempting to start a local H2O server...
  Java Version: openjdk version "21.0.8" 2025-07-15; OpenJDK Runtime Environment (build 21.0.8+9-Debian-1); OpenJDK 64-Bit Server VM (build 21.0.8+9-Debian-1, mixed mode, sharing)
  Starting server from /usr/local/lib/python3.11/site-packages/h2o/backend/bin/h2o.jar
  Ice root: /tmp/tmp2qg9__go
  JVM stdout: /tmp/tmp2qg9__go/h2o_unknownUser_started_from_python.out
  JVM stderr: /tmp/tmp2qg9__go/h2o_unknownUser_started_from_python.err
  Server is running at http://127.0.0.1:54321
Connecting to H2O server at http://127.0.0.1:54321 ... successful.
Warning: Your H2O cluster version is (5 months and 12 days) old.  There may be a newer version available.
Please download and install the latest version from: https://h2o-release.s3.amazonaws.com/h2o/latest_stable.html
--------------------------  ----------------------------------
H2O_cluster_uptime:         05 secs
H2O_cluster_timezone:       Etc/UTC
H2O_data_parsing_timezone:  UTC
H2O_cluster_version:        3.46.0.7
H2O_cluster_version_age:    5 months and 12 days
H2O_cluster_name:           H2O_from_python_unknownUser_0b6nvg
H2O_cluster_total_nodes:    1
H2O_cluster_free_memory:    1.982 Gb
H2O_cluster_total_cores:    16
H2O_cluster_allowed_cores:  16
H2O_cluster_status:         locked, healthy
H2O_connection_url:         http://127.0.0.1:54321
H2O_connection_proxy:       {"http": null, "https": null}
H2O_internal_security:      False
Python_version:             3.11.13 final
--------------------------  ----------------------------------
Parse progress: |████████████████████████████████████████████████████████████████| (done) 100%
LOG_START:UNSUPERVISED_LEARNING
Using Isolation Forest for anomaly detection
LOG_END:UNSUPERVISED_LEARNING
ERROR_START:ModelBuilderErrorV3  (water.exceptions.H2OModelBuilderIllegalArgumentException):     timestamp = 1757353614664     error_url = '/3/ModelBuilders/isolationforest'     msg = 'Illegal argument(s) for IsolationForest model: IsolationForest_model_python_1757353600736_1.  Details: ERRR on field: _response_column: Response column needs to be defined when using a validation frame.'     dev_msg = 'Illegal argument(s) for IsolationForest model: IsolationForest_model_python_1757353600736_1.  Details: ERRR on field: _response_column: Response column needs to be defined when using a validation frame.'     http_status = 412     values = {'messages': [{'_log_level': 5, '_field_name': '_keep_cross_validation_models', '_message': 'Only for cross-validation.'}, {'_log_level': 5, '_field_name': '_keep_cross_validation_predictions', '_message': 'Only for cross-validation.'}, {'_log_level': 5, '_field_name': '_keep_cross_validation_fold_assignment', '_message': 'Only for cross-validation.'}, {'_log_level': 5, '_field_name': '_fold_assignment', '_message': 'Only for cross-validation.'}, {'_log_level': 5, '_field_name': '_tweedie_power', '_message': 'Only for Tweedie Distribution.'}, {'_log_level': 2, '_field_name': '_train', '_message': 'Dropping bad and constant columns: [factura_monto_total__is_weekend, vendedor_id__is_month_end, factura_total_descuentos__year, factura_total_descuentos__is_month_start, factura_total_pagos__month, vendedor_id__year, vendedor_id__day, factura_total_pagos__year, factura_total_pagos__dayofweek, vendedor_id__is_weekend, factura_total_pagos__is_month_start, factura_total_pagos__day, factura_total_descuentos__is_month_end, factura_total_descuentos__dayofweek, factura_total_descuentos__is_weekend, factura_total_pagos__is_month_end, vendedor_id__dayofweek, factura_total_descuentos__day, vendedor_id__month, factura_nombre, factura_total_descuentos, factura_total_descuentos__month, factura_total_pagos__is_weekend]'}, {'_log_level': 5, '_field_name': '_balance_classes', '_message': 'Ignored for unsupervised methods.'}, {'_log_level': 5, '_field_name': '_class_sampling_factors', '_message': 'Ignored for unsupervised methods.'}, {'_log_level': 5, '_field_name': '_max_after_balance_size', '_message': 'Ignored for unsupervised methods.'}, {'_log_level': 5, '_field_name': '_max_confusion_matrix_size', '_message': 'Ignored for unsupervised methods.'}, {'_log_level': 1, '_field_name': '_response_column', '_message': 'Response column needs to be defined when using a validation frame.'}], 'algo': 'IsolationForest', 'parameters': {'_train': {'name': 'py_30_sid_80eb', 'type': 'Key'}, '_valid': {'name': 'py_31_sid_80eb', 'type': 'Key'}, '_nfolds': 0, '_keep_cross_validation_models': True, '_keep_cross_validation_predictions': False, '_keep_cross_validation_predictions_precision': -1, '_keep_cross_validation_fold_assignment': False, '_parallelize_cross_validation': True, '_auto_rebalance': True, '_preprocessors': None, '_seed': 42, '_fold_assignment': 'AUTO', '_categorical_encoding': 'AUTO', '_max_categorical_levels': 10, '_distribution': 'gaussian', '_tweedie_power': 1.5, '_quantile_alpha': 0.5, '_huber_alpha': 0.9, '_ignored_columns': None, '_ignore_const_cols': True, '_weights_column': None, '_offset_column': None, '_fold_column': None, '_treatment_column': None, '_check_constant_response': True, '_is_cv_model': False, '_cv_fold': -1, '_score_each_iteration': False, '_max_runtime_secs': 0.0, '_main_model_time_budget_factor': 0.0, '_stopping_rounds': 0, '_stopping_metric': 'AUTO', '_stopping_tolerance': 0.01, '_response_column': None, '_balance_classes': False, '_max_after_balance_size': 5.0, '_class_sampling_factors': None, '_max_confusion_matrix_size': 20, '_checkpoint': None, '_pretrained_autoencoder': None, '_custom_metric_func': None, '_custom_distribution_func': None, '_export_checkpoints_dir': None, '_gainslift_bins': -1, '_auc_type': 'AUTO', '_auuc_type': 'AUTO', '_auuc_nbins': -1, '_ntrees': 100, '_max_depth': 8, '_min_rows': 1.0, '_nbins': 2, '_nbins_cats': 2, '_min_split_improvement': 0.0, '_histogram_type': 'Random', '_r2_stopping': 1.7976931348623157e+308, '_nbins_top_level': 1024, '_build_tree_one_node': False, '_score_tree_interval': 0, '_initial_score_interval': 4000, '_score_interval': 4000, '_sample_rate': 0.8, '_sample_rate_per_class': None, '_calibrate_model': False, '_calibration_frame': None, '_calibration_method': 'AUTO', '_col_sample_rate_change_per_level': 1.0, '_col_sample_rate_per_tree': 1.0, '_parallel_main_model_building': False, '_use_best_cv_iteration': False, '_in_training_checkpoints_dir': None, '_in_training_checkpoints_tree_interval': 1, '_mtries': -1, '_sample_size': 256, '_contamination': -1.0}, 'error_count': 2}     exception_msg = 'Illegal argument(s) for IsolationForest model: IsolationForest_model_python_1757353600736_1.  Details: ERRR on field: _response_column: Response column needs to be defined when using a validation frame.'     stacktrace = ['water.exceptions.H2OModelBuilderIllegalArgumentException: Illegal argument(s) for IsolationForest model: IsolationForest_model_python_1757353600736_1.  Details: ERRR on field: _response_column: Response column needs to be defined when using a validation frame.\n', '    water.exceptions.H2OModelBuilderIllegalArgumentException.makeFromBuilder(H2OModelBuilderIllegalArgumentException.java:19)', '    hex.ModelBuilder.trainModelOnH2ONode(ModelBuilder.java:346)', '    water.api.ModelBuilderHandler.handle(ModelBuilderHandler.java:51)', '    water.api.ModelBuilderHandler.handle(ModelBuilderHandler.java:16)', '    water.api.RequestServer.serve(RequestServer.java:472)', '    water.api.RequestServer.doGeneric(RequestServer.java:303)', '    water.api.RequestServer.doPost(RequestServer.java:227)', '    javax.servlet.http.HttpServlet.service(HttpServlet.java:707)', '    javax.servlet.http.HttpServlet.service(HttpServlet.java:790)', '    org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)', '    org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:554)', '    org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)', '    org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)', '    org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)', '    org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)', '    org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)', '    org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)', '    org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)', '    org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)', '    org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)', '    water.webserver.jetty9.Jetty9ServerAdapter$LoginHandler.handle(Jetty9ServerAdapter.java:130)', '    org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)', '    org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)', '    org.eclipse.jetty.server.Server.handle(Server.java:516)', '    org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)', '    org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)', '    org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)', '    org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)', '    org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)', '    org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)', '    org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)', '    org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)', '    org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)', '    org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)', '    org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)', '    org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)', '    org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)', '    org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)', '    java.base/java.lang.Thread.run(Thread.java:1583)']     parameters = {'__meta': {'schema_version': 3, 'schema_name': 'IsolationForestParametersV3', 'schema_type': 'IsolationForestParameters'}, 'model_id': None, 'training_frame': {'__meta': {'schema_version': 3, 'schema_name': 'FrameKeyV3', 'schema_type': 'Key<Frame>'}, 'name': 'py_30_sid_80eb', 'type': 'Key<Frame>', 'URL': '/3/Frames/py_30_sid_80eb'}, 'validation_frame': {'__meta': {'schema_version': 3, 'schema_name': 'FrameKeyV3', 'schema_type': 'Key<Frame>'}, 'name': 'py_31_sid_80eb', 'type': 'Key<Frame>', 'URL': '/3/Frames/py_31_sid_80eb'}, 'nfolds': 0, 'keep_cross_validation_models': True, 'keep_cross_validation_predictions': False, 'keep_cross_validation_fold_assignment': False, 'parallelize_cross_validation': True, 'distribution': 'gaussian', 'tweedie_power': 1.5, 'quantile_alpha': 0.5, 'huber_alpha': 0.9, 'response_column': None, 'weights_column': None, 'offset_column': None, 'fold_column': None, 'fold_assignment': 'AUTO', 'categorical_encoding': 'AUTO', 'max_categorical_levels': 10, 'ignored_columns': None, 'ignore_const_cols': True, 'score_each_iteration': False, 'checkpoint': None, 'stopping_rounds': 0, 'max_runtime_secs': 0.0, 'stopping_metric': 'AUTO', 'stopping_tolerance': 0.01, 'gainslift_bins': -1, 'custom_metric_func': None, 'custom_distribution_func': None, 'export_checkpoints_dir': None, 'auc_type': 'AUTO', 'balance_classes': False, 'class_sampling_factors': None, 'max_after_balance_size': 5.0, 'max_confusion_matrix_size': 20, 'ntrees': 100, 'max_depth': 8, 'min_rows': 1.0, 'nbins': 2, 'nbins_top_level': 1024, 'nbins_cats': 2, 'r2_stopping': 1.7976931348623157e+308, 'seed': 42, 'build_tree_one_node': False, 'sample_rate_per_class': None, 'col_sample_rate_per_tree': 1.0, 'col_sample_rate_change_per_level': 1.0, 'score_tree_interval': 0, 'min_split_improvement': 0.0, 'histogram_type': 'Random', 'calibrate_model': False, 'calibration_frame': None, 'calibration_method': 'AUTO', 'check_constant_response': True, 'in_training_checkpoints_dir': None, 'in_training_checkpoints_tree_interval': 1, 'sample_size': 256, 'sample_rate': 0.8, 'mtries': -1, 'contamination': -1.0, 'validation_response_column': None}     messages = [{'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'keep_cross_validation_models', 'message': 'Only for cross-validation.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'keep_cross_validation_predictions', 'message': 'Only for cross-validation.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'keep_cross_validation_fold_assignment', 'message': 'Only for cross-validation.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'fold_assignment', 'message': 'Only for cross-validation.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'tweedie_power', 'message': 'Only for Tweedie Distribution.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'WARN', 'field_name': 'train', 'message': 'Dropping bad and constant columns: [factura_monto_total__is_weekend, vendedor_id__is_month_end, factura_total_descuentos__year, factura_total_descuentos__is_month_start, factura_total_pagos__month, vendedor_id__year, vendedor_id__day, factura_total_pagos__year, factura_total_pagos__dayofweek, vendedor_id__is_weekend, factura_total_pagos__is_month_start, factura_total_pagos__day, factura_total_descuentos__is_month_end, factura_total_descuentos__dayofweek, factura_total_descuentos__is_weekend, factura_total_pagos__is_month_end, vendedor_id__dayofweek, factura_total_descuentos__day, vendedor_id__month, factura_nombre, factura_total_descuentos, factura_total_descuentos__month, factura_total_pagos__is_weekend]'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'balance_classes', 'message': 'Ignored for unsupervised methods.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'class_sampling_factors', 'message': 'Ignored for unsupervised methods.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'max_after_balance_size', 'message': 'Ignored for unsupervised methods.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'TRACE', 'field_name': 'max_confusion_matrix_size', 'message': 'Ignored for unsupervised methods.'}, {'__meta': {'schema_version': 3, 'schema_name': 'ValidationMessageV3', 'schema_type': 'ValidationMessage'}, 'message_type': 'ERRR', 'field_name': 'response_column', 'message': 'Response column needs to be defined when using a validation frame.'}]     error_count = 2 :ERROR_END
H2O session _sid_80eb closed.

